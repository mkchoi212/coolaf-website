<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Monoids deployed - 0xDEADBEEF</title>
    <meta name="description" content="  First of all, an explanation of the title is in order. I used the word ‚Äúdeployed‚Äù just because it kind of rhymed with ‚ÄúMonoid‚Äù. It‚Äôs probably a better choi...">

    <link href='https://fonts.googleapis.com/css?family=Roboto+Mono|Roboto:300,400,900,400italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://www.deadbeef.me/2017/09/monoids">
    <link rel="alternate" type="application/rss+xml" title="0xDEADBEEF" href="https://www.deadbeef.me/feed.xml">
    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Monoids deployed | 0xDEADBEEF</title>
<meta name="generator" content="Jekyll v3.4.3" />
<meta property="og:title" content="Monoids deployed" />
<meta name="author" content="Mike JS. Choi" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Understanding Monoids" />
<meta property="og:description" content="Understanding Monoids" />
<link rel="canonical" href="https://www.deadbeef.me/2017/09/monoids" />
<meta property="og:url" content="https://www.deadbeef.me/2017/09/monoids" />
<meta property="og:site_name" content="0xDEADBEEF" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-09-22T23:34:45-05:00" />
<script type="application/ld+json">
{"description":"Understanding Monoids","author":{"@type":"Person","name":"Mike JS. Choi"},"@type":"BlogPosting","url":"https://www.deadbeef.me/2017/09/monoids","headline":"Monoids deployed","dateModified":"2017-09-22T23:34:45-05:00","datePublished":"2017-09-22T23:34:45-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.deadbeef.me/2017/09/monoids"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

    <body>
        <main class="u-container">
        <div class="c-page">
    <header class="c-page__header">
    <h1><code>0xDEADBEEF</code></h1>

    
    <p>
        <a href="/">Home</a><span
          class="u-separate"></span> <a href="/projects/">Projects</a><span class="u-separate"></span> <a href="/about/">About</a><span class="u-separate"></span><a href="/feed.xml">RSS</a>
    </p>
</header>

    <div class="c-page__main">
    <article class="c-article">
    <header class="c-article__header">
        <h1 class="c-article__title">Monoids deployed</h1>
        <p class="c-article__time"><time datetime="2017-09-22T23:34:45-05:00" itemprop="datePublished">Sep 22, 2017</time></p>
    </header>
    
    <!-- Post Tags -->
    <ul class="c-tags">
    
      <li class="c-tag">haskell</li>
    
      <li class="c-tag">swift</li>
    
      <li class="c-tag">fp</li>
    
    </ul>

    <div class="c-article__main">
        <blockquote>
  <p>First of all, an explanation of the title is in order. I used the word ‚Äúdeployed‚Äù just because it kind of rhymed with ‚ÄúMonoid‚Äù. It‚Äôs probably a better choice than what I was originally going to use; ‚ÄúMonoids on Steroids‚Äù.</p>
</blockquote>

<p>Anyways, this post will be an attempt to explain what monoids are, why they are useful and most importantly, how they can be used. We will also build a simple shapes library in Haskell and Swift as an example.</p>

<p>To start off with, here is an example of a monoid. Ready?</p>

<div class="highlighter-rouge"><pre class="highlight"><code>1 + 0 = 1
0 + 1 = 1
1 + (2 + 3) = 6
(1 + 2) + 3 = 6
</code></pre>
</div>

<p>If you understand these highly complex mathematical equations, you understand what monoids are. Congratulations üéâüéâüéâ.</p>

<h1 id="formal-definition">Formal Definition</h1>

<h2 id="mathematical">Mathematical</h2>

<p>A monoid is a tuple <code class="highlighter-rouge">(M, op, e)</code> where</p>

<ul>
  <li>M is a set of element</li>
  <li><code class="highlighter-rouge">op</code> is an associative binary operation on two elements <code class="highlighter-rouge">M</code>, returning a new element of <code class="highlighter-rouge">M</code></li>
  <li><code class="highlighter-rouge">e</code> is an element of <code class="highlighter-rouge">M</code>, neutral for <code class="highlighter-rouge">op</code> on both left and right side</li>
</ul>

<p>So for example, the above addition operator would form the following tuple of <code class="highlighter-rouge">(Int, +, 0)</code></p>

<h2 id="statically-typed-languages">Statically typed languages</h2>

<p>Since we are programmers, let us translate the above definition to code. A monoid consists of a type <code class="highlighter-rouge">T</code> and a function <code class="highlighter-rouge">f</code> where</p>

<h2 id="f-takes-an-instance-of-t-and-returns-an-instance-of-t"><code class="highlighter-rouge">f</code> takes an instance of <code class="highlighter-rouge">T</code> and returns an instance of <code class="highlighter-rouge">T</code></h2>

<p><code class="highlighter-rouge">func foobar(_ in: String, _in2: String) -&gt; String</code></p>

<p>The above statement says that a binary operation of monoids takes two elements of type <code class="highlighter-rouge">T</code> and will always return <code class="highlighter-rouge">T</code>. The input type is same as the output type. This property is very important as it will <strong>allows us to chain operations indefinitely.</strong></p>

<h2 id="f-is-associative"><code class="highlighter-rouge">f</code> is associative</h2>

<p>Associative property is when <code class="highlighter-rouge">f(c, f(a, b)) == f(f(c, a), b)</code> holds true.</p>

<p>In other words, we are looking for the situation where something like <code class="highlighter-rouge">1 + (2 + 3) == (1 + 2) + 3</code> makes sense. This allows us to not worry about the ordering when we compose functions. We will see examples of this later.</p>

<h2 id="f-has-a-neutral-element-e-where-fe-a--fa-e"><code class="highlighter-rouge">f</code> has a neutral element <code class="highlighter-rouge">e</code> where <code class="highlighter-rouge">f(e, a) == f(a, e)</code></h2>

<p>We are looking for <code class="highlighter-rouge">e</code> that allows <code class="highlighter-rouge">foobar(NEUTRAL_ELEMENT, 5) == foobar(5, NEUTRAL_ELEMENT)</code></p>

<p>For example, <code class="highlighter-rouge">0</code> is the neutral element for the addition operator since <code class="highlighter-rouge">0 + 3 == 3 + 0</code></p>

<h1 id="monoids-everywhere">Monoids everywhere</h1>

<p>By now, you hopefully have a sense of what monoids are. And the funny thing is, you probably have been using monoids all along without evening knowing it. Here are some examples of commonly used monoids that are unfortuantley not acknowledged as monoids most of the time.</p>

<ul>
  <li>Integers under addition with neutral element zero</li>
  <li>Integers under multiplication with neutral element one</li>
  <li>Sequential containers under concatenation (<code class="highlighter-rouge">String</code>, <code class="highlighter-rouge">List</code>)</li>
  <li>Associative containers under union (<code class="highlighter-rouge">map</code>, <code class="highlighter-rouge">set</code>)</li>
</ul>

<h1 id="but-why-should-i-care">But why should I care?</h1>

<p>Th idea of monoids come from the realms of functional programming where the ultimate goal is to come up with simple abstractions that can later be composed to create complex behaviors. <strong>Monoids are a great representation of the FP mindset as it gives us a way to build complexity out of simplicity.</strong> This means that before you dive into a problem, you can start by formulating a very simple idea. Once you solidify this idea, you can then use it to build complex objects that will eventually solve your problem.</p>

<h1 id="ascii-art-generator">ASCII Art Generator</h1>

<p>To see how monoids can be used, we will create a library with power enough abstractions that will allows us to create some interesting ASCII art. Our library will mainly deal with creating geometric shapes.<sup id="fnref:1"><a href="#fn:1" class="footnote">1</a></sup> As we go through the code, I will demonstrate each example in <em>Haskell and then follow up with Swift.</em></p>

<h2 id="abstracting-a-shape">Abstracting a ‚ÄúShape‚Äù</h2>

<p>Here, we will <strong>define a shape as a function that takes a coordinate point as an input and returns a boolean as an output</strong>. The idea is simple; you ask the function if the point <code class="highlighter-rouge">(x, y)</code> is contained in the shape and, if  <code class="highlighter-rouge">true</code> is returned, we then know it‚Äôs part of the shape.</p>

<p>To define a shape, we will make a <code class="highlighter-rouge">Shape</code> type with the function - <code class="highlighter-rouge">isInShape</code> - I just described above. We will also define some typealiases to make life easier. Notice that we are using a generic struct. This is so that we can use not only <code class="highlighter-rouge">Coord2D</code> but also <code class="highlighter-rouge">Coord3D</code>,  <code class="highlighter-rouge">Coord4D</code> in the future.</p>

<div class="language-haskell highlighter-rouge"><pre class="highlight"><code><span class="kr">newtype</span> <span class="kt">Shape</span> <span class="n">coord</span> <span class="o">=</span> <span class="kt">Shape</span> <span class="p">{</span>	  
  <span class="n">isInShape</span> <span class="o">::</span> <span class="n">coord</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>	
<span class="p">}</span>
<span class="kr">type</span> <span class="kt">Coord2D</span> <span class="o">=</span> <span class="p">(</span><span class="kt">Double</span><span class="p">,</span> <span class="kt">Double</span><span class="p">)</span>	
<span class="kr">type</span> <span class="kt">Shape2D</span> <span class="o">=</span> <span class="kt">Shape</span> <span class="kt">Coord2D</span>
</code></pre>
</div>

<div class="language-swift highlighter-rouge"><pre class="highlight"><code><span class="kd">struct</span> <span class="kt">Shape</span><span class="o">&lt;</span><span class="kt">C</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">isInShape</span> <span class="p">:</span> <span class="p">(</span><span class="kt">C</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="kt">Bool</span><span class="p">)</span>
<span class="p">}</span>
<span class="kd">typealias</span> <span class="kt">Coord2D</span> <span class="o">=</span> <span class="p">(</span><span class="kt">Double</span><span class="p">,</span> <span class="kt">Double</span><span class="p">)</span>
<span class="kd">typealias</span> <span class="kt">Shape2D</span> <span class="o">=</span> <span class="kt">Shape</span><span class="o">&lt;</span><span class="kt">Coord2D</span><span class="o">&gt;</span>
</code></pre>
</div>

<p>Because we are describing shapes as functions, we can easily define the complement of a shape. For example, we can make the function <code class="highlighter-rouge">outside</code>. All it would have to do is negate the predicate of the input shape.</p>

<div class="language-haskell highlighter-rouge"><pre class="highlight"><code><span class="n">outside</span> <span class="o">::</span> <span class="kt">Shape</span> <span class="n">coord</span> <span class="o">-&gt;</span> <span class="kt">Shape</span> <span class="n">coord</span>
<span class="n">outside</span> <span class="n">s</span> <span class="o">=</span> <span class="kt">Shape</span> <span class="p">(</span><span class="n">not</span> <span class="o">.</span> <span class="n">isInShape</span> <span class="n">s</span><span class="p">)</span>
</code></pre>
</div>

<div class="language-swift highlighter-rouge"><pre class="highlight"><code><span class="c1">// Thanks to u/thisischemistry, code is now more understandable and self-documenting</span>
<span class="kd">extension</span> <span class="kt">Shape</span> <span class="p">{</span>
  <span class="kd">func</span> <span class="nf">outside</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Shape</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">notInOriginalShape</span> <span class="o">=</span> <span class="p">{</span> <span class="n">coord</span> <span class="k">in</span>
      <span class="o">!</span><span class="p">(</span><span class="k">self</span><span class="o">.</span><span class="nf">isInShape</span><span class="p">(</span><span class="n">coord</span><span class="p">))</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="kt">Shape</span><span class="p">(</span><span class="nv">isInShape</span><span class="p">:</span> <span class="n">notInOriginalShape</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<h2 id="creating-shapes">Creating Shapes</h2>

<p>To define a shape, we need to specify the <code class="highlighter-rouge">isInShape</code> function to describe whether a point belongs in the shape or not. Here‚Äôs how we would define a disk.</p>

<div class="language-haskell highlighter-rouge"><pre class="highlight"><code><span class="n">disk</span> <span class="o">::</span> <span class="kt">Coord2D</span> <span class="o">-&gt;</span> <span class="kt">Radius</span> <span class="o">-&gt;</span> <span class="kt">Shape2D</span>	
<span class="n">disk</span> <span class="n">center</span> <span class="n">radius</span> <span class="o">=</span>
	<span class="kt">Shape</span> <span class="o">$</span> <span class="nf">\</span><span class="n">coord</span> <span class="o">-&gt;</span> <span class="n">euclidianDistance</span> <span class="n">center</span> <span class="n">coord</span> <span class="o">&lt;=</span> <span class="n">radius</span>
</code></pre>
</div>

<div class="language-swift highlighter-rouge"><pre class="highlight"><code><span class="kd">extension</span> <span class="kt">Shape</span> <span class="p">{</span>
  <span class="nf">init</span><span class="p">(</span><span class="nv">center</span><span class="p">:</span> <span class="kt">Coord2D</span><span class="p">,</span> <span class="nv">radius</span><span class="p">:</span> <span class="kt">Double</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">isInShape</span> <span class="o">=</span> <span class="p">{</span> <span class="n">coord</span> <span class="k">in</span>
      <span class="k">guard</span> <span class="k">let</span> <span class="nv">coord</span> <span class="o">=</span> <span class="n">coord</span> <span class="k">as?</span> <span class="kt">Coord2D</span> <span class="k">else</span> <span class="p">{</span> <span class="nf">fatalError</span><span class="p">(</span><span class="s">"Center must be a 2D point"</span><span class="p">)</span> <span class="p">}</span>
      <span class="k">return</span> <span class="nf">euclidianDistance</span><span class="p">(</span><span class="nv">p1</span><span class="p">:</span> <span class="n">center</span><span class="p">,</span> <span class="nv">p2</span><span class="p">:</span> <span class="n">coord</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">radius</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
</div>

<p>Now, we can experiment and have some fun with some sample coordinates</p>

<div class="language-swift highlighter-rouge"><pre class="highlight"><code><span class="k">let</span> <span class="nv">disk</span> <span class="o">=</span> <span class="kt">Shape</span><span class="o">&lt;</span><span class="kt">Coord2D</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">center</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span> <span class="nv">radius</span><span class="p">:</span> <span class="mf">8.00</span><span class="p">)</span>
<span class="n">disk</span><span class="o">.</span><span class="nf">isInShape</span><span class="p">((</span><span class="mf">13.0</span><span class="p">,</span> <span class="mf">13.0</span><span class="p">))</span>
<span class="o">&gt;</span> <span class="kc">true</span>
</code></pre>
</div>

<p>And with a simple loop, we can print the disk out. The output looks a bit off because the line widths are larger than the character spacings. But hey, still pretty cool, eh?</p>

<div class="highlighter-rouge"><pre class="highlight"><code>      *******                                     
     ***********                                   
    *************                                  
    *************                                  
   ***************                                 
   ***************                                 
   ***************                                 
   ***************                                 
   ***************                                 
   ***************                                 
   ***************                                 
    *************                                  
    *************                                  
     ***********                                   
       *******                                     
</code></pre>
</div>

<p class="center"><img src="https://media.giphy.com/media/6pSJGZW0ZmbUA/giphy.gif" alt="Awesome!" /></p>

<h2 id="complex-shapes">Complex shapes</h2>

<p>Now that we have our basic idea down, let‚Äôs stat complicating things. And since we are in the realm of FP, what would this post be without some composition!? Let‚Äôs try to build cooler shapes via composition.</p>

<p>We can first start by defining the <code class="highlighter-rouge">intersect</code> function which defines a new shape within the region of intersection.</p>

<div class="language-haskell highlighter-rouge"><pre class="highlight"><code><span class="n">intersect</span> <span class="o">::</span> <span class="kt">Shape</span> <span class="n">coord</span> <span class="o">-&gt;</span> <span class="kt">Shape</span> <span class="n">coord</span> <span class="o">-&gt;</span> <span class="kt">Shape</span> <span class="n">coord</span>	
<span class="n">intersect</span> <span class="n">s1</span> <span class="n">s2</span> <span class="o">=</span>	  
	<span class="kt">Shape</span> <span class="o">$</span> <span class="nf">\</span><span class="n">coord</span> <span class="o">-&gt;</span> <span class="n">isInShape</span> <span class="n">s1</span> <span class="n">coord</span> <span class="o">&amp;&amp;</span> <span class="n">isInShape</span> <span class="n">s2</span> <span class="n">coord</span>
</code></pre>
</div>

<div class="language-swift highlighter-rouge"><pre class="highlight"><code><span class="kd">extension</span> <span class="kt">Shape</span> <span class="p">{</span>
  <span class="kd">func</span> <span class="nf">intersect</span><span class="p">(</span><span class="n">_</span> <span class="nv">s1</span><span class="p">:</span> <span class="kt">Shape</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Shape</span> <span class="p">{</span> 
    <span class="k">return</span> <span class="kt">Shape</span> <span class="p">{</span> <span class="n">coord</span> <span class="k">in</span>
      <span class="k">self</span><span class="o">.</span><span class="nf">isInShape</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">s1</span><span class="o">.</span><span class="nf">isInShape</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
  
<span class="k">let</span> <span class="nv">disk</span> <span class="o">=</span> <span class="kt">Shape</span><span class="o">&lt;</span><span class="kt">Coord2D</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">center</span><span class="p">:</span> <span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">),</span> <span class="nv">radius</span><span class="p">:</span> <span class="mf">8.00</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">square</span> <span class="o">=</span> <span class="kt">Shape</span><span class="o">&lt;</span><span class="kt">Coord2D</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">origin</span><span class="p">:</span> <span class="p">(</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">),</span> <span class="nv">width</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="nv">height</span><span class="p">:</span> <span class="mi">6</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">ring</span> <span class="o">=</span> <span class="n">disk</span><span class="o">.</span><span class="nf">intersect</span><span class="p">(</span><span class="n">square</span><span class="o">.</span><span class="nf">outside</span><span class="p">())</span>
</code></pre>
</div>

<p>Printing <code class="highlighter-rouge">ring</code> yields the below result</p>

<div class="highlighter-rouge"><pre class="highlight"><code>      ********                                     
     ***********                                   
    *************                                  
    *************                                  
   ****       ****                                 
   ****       ****                                 
   ****       ****                                 
   ****       ****                                 
   ****       ****                                 
   ****       ****                                 
   ****       ****                                 
    *************                                  
    *************                                  
     ***********                                   
       *******      
</code></pre>
</div>

<p>Kind of looks like those rings from Sonic, eh?</p>

<p class="center"><img src="https://media.giphy.com/media/2mmYAQ23kZ3XO/giphy.gif" alt="S'cute!" /></p>

<h1 id="wrapping-up">Wrapping Up</h1>

<p>I hope the shapes example demonstrated how great monoids are when it comes to composition and abstraction. Personally, I have constantly failed to recognize the fact that I have been using something people have discovered, named and implemented. I try to recognize them and utilize them when I code but it can be very hard to do so.</p>

<p>Monoids are a great example of this. It‚Äôs something functional programmers use all the time but is something that never gets called out explicitly in imperative programming languages. I think this is a shame because once you recognize the fact that something is a monoid, you get access to some incredible perspectives from where you can look at your code.</p>

<p>Anyways, the one thing I wish you got away from this post is that after recognizing a good use case for a monoid, you can start with something really simple. Then, as the logic grows, you can build something very complex on top of a very firm foundation.</p>

<div class="footnotes">
  <ol>
    <li id="fn:1">
      <p><a href="http://conal.net">Conal Elliott</a>¬†<a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

    </div>
  
    <!-- Previous / Next Buttons -->
    
    

    
    

    <div class="pagenav">
		
        <div class="wrapper" id="left">
          <small><b>Previous</b> Sep 16, 2017</small>
          <br>
            <a class="no-hov" href="/2017/09/reentrant-threadsafe">&laquo; Reentrant and Threadsafe Code</a>
        </div>
		
		
        <div class="wrapper" id="right">
          <small>Dec 14, 2017 <b>Next</b></small>
          <br>
          <a class="no-hov" href="/2017/12/rss">RSS == Really Sucky Syndrome &raquo;</a>
        </div>
		
		</div>

		<!-- Disqus comments view -->
		
		<div class="post-disqus">
				<section id="disqus_thread"></section>
				<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables */

var disqus_config = function () {
  this.page.url = 'https://www.deadbeef.me/2017/09/monoids';  // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = '/2017/09/monoids'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://deadbeef-me.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

		</div>
		
</article>

    </div>
    <footer class="c-page__footer">
    <p>&copy; Mike JS. Choi 2018</p>
    <p><a href="https://twitter.com/bananamlkshake2">Twitter</a><span class="u-separate"></span><a href="https://github.com/mkchoi212">Github</a></p>
</footer>

</div>

        </main>
    
    </body>
</html>
